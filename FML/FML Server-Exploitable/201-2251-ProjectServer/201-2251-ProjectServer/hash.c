#include <stdio.h>
#include <stdlib.h>
#include "hash.h"
#include <string.h>



void printHash(unsigned char* hash) {
	for (int i = 0; i < HASH_LEN; i++) {
		printf("%02x ", hash[i]);
	}
}

int compareHashes(unsigned char* hash1, unsigned char* hash2) {
	for (int i = 0; i < HASH_LEN; i++) {
		if (hash1[i] != hash2[i]) return 0;
	}
	return 1;
}

unsigned char* hashfunc(char* cmd, unsigned char* hash) {
	unsigned char seedA = 'A';
	unsigned char seedB = 'B';
	unsigned char seedC = 'C';
	unsigned char seedD = 'D';
	unsigned char seedE = 'E';
	unsigned char* newhash;

	if (cmd != NULL && hash != NULL) {
		for (int i = 0; i < strlen(cmd); i++) {
			seedE = seedA + seedB + seedC + seedD;
			seedA = (seedB | cmd[i]) << 2;
			seedB = (seedC & cmd[i]) >> 2;
			seedC = (seedD ^ cmd[i]);
			seedD = (~(seedE + cmd[i]));
		}
		for (int i = 0; i < HASH_LEN; i++) {
			seedE = seedA + seedB + seedC + seedD;
			seedA = (seedB | hash[i]) << 2;
			seedB = (seedC & hash[i]) >> 2;
			seedC = (seedD ^ hash[i]);
			seedD = (~(seedE + hash[i]));
		}
	}

	newhash = (unsigned char*)malloc(sizeof(unsigned char) * HASH_LEN);
	newhash[0] = seedA;
	newhash[1] = seedB;
	newhash[2] = seedC;
	newhash[3] = seedD;
	newhash[4] = seedE;

	return newhash;

}